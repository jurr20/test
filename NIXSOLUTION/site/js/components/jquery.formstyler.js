(function(a){'function'==typeof define&&define.amd?define(['jquery'],a):'object'==typeof exports?module.exports=a(require('jquery')):a(jQuery)})(function(a){'use strict';function b(g,h){this.element=g,this.options=a.extend({},f,h);var j=this.options.locale;this.options.locales[j]!==void 0&&a.extend(this.options,this.options.locales[j]),this.init()}function c(g){if(!a(g.target).parents().hasClass('jq-selectbox')&&'OPTION'!=g.target.nodeName&&a('div.jq-selectbox.opened').length){var h=a('div.jq-selectbox.opened'),j=a('div.jq-selectbox__search input',h),m=a('div.jq-selectbox__dropdown',h),n=h.find('select').data('_'+d).options;n.onSelectClosed.call(h),j.length&&j.val('').keyup(),m.hide().find('li.sel').addClass('selected'),h.removeClass('focused opened dropup dropdown')}}var d='styler',f={idSuffix:'-styler',filePlaceholder:'\u0424\u0430\u0439\u043B \u043D\u0435 \u0432\u044B\u0431\u0440\u0430\u043D',fileBrowse:'\u041E\u0431\u0437\u043E\u0440...',fileNumber:'\u0412\u044B\u0431\u0440\u0430\u043D\u043E \u0444\u0430\u0439\u043B\u043E\u0432: %s',selectPlaceholder:'\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435...',selectSearch:!1,selectSearchLimit:10,selectSearchNotFound:'\u0421\u043E\u0432\u043F\u0430\u0434\u0435\u043D\u0438\u0439 \u043D\u0435 \u043D\u0430\u0439\u0434\u0435\u043D\u043E',selectSearchPlaceholder:'\u041F\u043E\u0438\u0441\u043A...',selectVisibleOptions:0,singleSelectzIndex:'100',selectSmartPositioning:!0,locale:'ru',locales:{en:{filePlaceholder:'No file selected',fileBrowse:'Browse...',fileNumber:'Selected files: %s',selectPlaceholder:'Select...',selectSearchNotFound:'No matches found',selectSearchPlaceholder:'Search...'}},onSelectOpened:function(){},onSelectClosed:function(){},onFormStyled:function(){}};b.prototype={init:function(){function g(){h.attr('id')!==void 0&&''!==h.attr('id')&&(this.id=h.attr('id')+j.idSuffix),this.title=h.attr('title'),this.classes=h.attr('class'),this.data=h.data()}var h=a(this.element),j=this.options,m=navigator.userAgent.match(/(iPad|iPhone|iPod)/i)&&!navigator.userAgent.match(/(Windows\sPhone)/i),n=navigator.userAgent.match(/Android/i)&&!navigator.userAgent.match(/(Windows\sPhone)/i);if(h.is(':checkbox')){var o=function(){var u=new g,v=a('<div class="jq-checkbox"><div class="jq-checkbox__div"></div></div>').attr({id:u.id,title:u.title}).addClass(u.classes).data(u.data);h.css({position:'absolute',zIndex:'-1',opacity:0,margin:0,padding:0}).after(v).prependTo(v),v.attr('unselectable','on').css({'-webkit-user-select':'none','-moz-user-select':'none','-ms-user-select':'none','-o-user-select':'none','user-select':'none',display:'inline-block',position:'relative',overflow:'hidden'}),h.is(':checked')&&v.addClass('checked'),h.is(':disabled')&&v.addClass('disabled'),v.click(function(w){w.preventDefault(),v.is('.disabled')||(h.is(':checked')?(h.prop('checked',!1),v.removeClass('checked')):(h.prop('checked',!0),v.addClass('checked')),h.focus().change())}),h.closest('label').add('label[for="'+h.attr('id')+'"]').on('click.styler',function(w){a(w.target).is('a')||a(w.target).closest(v).length||(v.triggerHandler('click'),w.preventDefault())}),h.on('change.styler',function(){h.is(':checked')?v.addClass('checked'):v.removeClass('checked')}).on('keydown.styler',function(w){32==w.which&&v.click()}).on('focus.styler',function(){v.is('.disabled')||v.addClass('focused')}).on('blur.styler',function(){v.removeClass('focused')})};o(),h.on('refresh',function(){h.closest('label').add('label[for="'+h.attr('id')+'"]').off('.styler'),h.off('.styler').parent().before(h).remove(),o()})}else if(h.is(':radio')){var p=function(){var u=new g,v=a('<div class="jq-radio"><div class="jq-radio__div"></div></div>').attr({id:u.id,title:u.title}).addClass(u.classes).data(u.data);h.css({position:'absolute',zIndex:'-1',opacity:0,margin:0,padding:0}).after(v).prependTo(v),v.attr('unselectable','on').css({'-webkit-user-select':'none','-moz-user-select':'none','-ms-user-select':'none','-o-user-select':'none','user-select':'none',display:'inline-block',position:'relative'}),h.is(':checked')&&v.addClass('checked'),h.is(':disabled')&&v.addClass('disabled'),a.fn.commonParents=function(){var w=this;return w.first().parents().filter(function(){return a(this).find(w).length===w.length})},a.fn.commonParent=function(){return a(this).commonParents().first()},v.click(function(w){if(w.preventDefault(),!v.is('.disabled')){var x=a('input[name="'+h.attr('name')+'"]');x.commonParent().find(x).prop('checked',!1).parent().removeClass('checked'),h.prop('checked',!0).parent().addClass('checked'),h.focus().change()}}),h.closest('label').add('label[for="'+h.attr('id')+'"]').on('click.styler',function(w){a(w.target).is('a')||a(w.target).closest(v).length||(v.triggerHandler('click'),w.preventDefault())}),h.on('change.styler',function(){h.parent().addClass('checked')}).on('focus.styler',function(){v.is('.disabled')||v.addClass('focused')}).on('blur.styler',function(){v.removeClass('focused')})};p(),h.on('refresh',function(){h.closest('label').add('label[for="'+h.attr('id')+'"]').off('.styler'),h.off('.styler').parent().before(h).remove(),p()})}else if(h.is(':file')){h.css({position:'absolute',top:0,right:0,margin:0,padding:0,opacity:0,fontSize:'100px'});var q=function(){var u=new g,v=h.data('placeholder');v===void 0&&(v=j.filePlaceholder);var w=h.data('browse');(w===void 0||''===w)&&(w=j.fileBrowse);var x=a('<div class="jq-file"><div class="jq-file__name">'+v+'</div><div class="jq-file__browse">'+w+'</div></div>').css({display:'inline-block',position:'relative',overflow:'hidden'}).attr({id:u.id,title:u.title}).addClass(u.classes).data(u.data);h.after(x).appendTo(x),h.is(':disabled')&&x.addClass('disabled'),h.on('change.styler',function(){var y=h.val(),z=a('div.jq-file__name',x);if(h.is('[multiple]')){y='';var A=h[0].files.length;if(0<A){var B=h.data('number');B===void 0&&(B=j.fileNumber),B=B.replace('%s',A),y=B}}z.text(y.replace(/.+[\\\/]/,'')),''===y?(z.text(v),x.removeClass('changed')):x.addClass('changed')}).on('focus.styler',function(){x.addClass('focused')}).on('blur.styler',function(){x.removeClass('focused')}).on('click.styler',function(){x.removeClass('focused')})};q(),h.on('refresh',function(){h.off('.styler').parent().before(h).remove(),q()})}else if(h.is('input[type="number"]')){var r=function(){var u=new g,v=a('<div class="jq-number"><div class="jq-number__spin minus"></div><div class="jq-number__spin plus"></div></div>').attr({id:u.id,title:u.title}).addClass(u.classes).data(u.data);h.after(v).prependTo(v).wrap('<div class="jq-number__field"></div>'),h.is(':disabled')&&v.addClass('disabled');var w,x,y,z=null,A=null;h.attr('min')!==void 0&&(w=h.attr('min')),h.attr('max')!==void 0&&(x=h.attr('max')),y=void 0!==h.attr('step')&&a.isNumeric(h.attr('step'))?+h.attr('step'):1;var B=function(C){var E,D=h.val();a.isNumeric(D)||(D=0,h.val('0')),C.is('.minus')?E=+D-y:C.is('.plus')&&(E=+D+y);var F=(y.toString().split('.')[1]||[]).length;if(0<F){for(var G='1';G.length<=F;)G+='0';E=Math.round(E*G)/G}a.isNumeric(w)&&a.isNumeric(x)?E>=w&&E<=x&&h.val(E):a.isNumeric(w)&&!a.isNumeric(x)?E>=w&&h.val(E):!a.isNumeric(w)&&a.isNumeric(x)?E<=x&&h.val(E):h.val(E)};v.is('.disabled')||(v.on('mousedown','div.jq-number__spin',function(){var C=a(this);B(C),z=setTimeout(function(){A=setInterval(function(){B(C)},40)},350)}).on('mouseup mouseout','div.jq-number__spin',function(){clearTimeout(z),clearInterval(A)}).on('mouseup','div.jq-number__spin',function(){h.change()}),h.on('focus.styler',function(){v.addClass('focused')}).on('blur.styler',function(){v.removeClass('focused')}))};r(),h.on('refresh',function(){h.off('.styler').closest('.jq-number').before(h).remove(),r()})}else if(h.is('select')){var s=function(){function u(A){A.off('mousewheel DOMMouseScroll').on('mousewheel DOMMouseScroll',function(B){var C=null;'mousewheel'==B.type?C=-1*B.originalEvent.wheelDelta:'DOMMouseScroll'==B.type&&(C=40*B.originalEvent.detail),C&&(B.stopPropagation(),B.preventDefault(),a(this).scrollTop(C+a(this).scrollTop()))})}function v(){for(var A=0;A<y.length;A++){var B=y.eq(A),C='',D='',E='',F='',G='',H='',I='',J='',K='';B.prop('selected')&&(D='selected sel'),B.is(':disabled')&&(D='disabled'),B.is(':selected:disabled')&&(D='selected sel disabled'),B.attr('id')!==void 0&&''!==B.attr('id')&&(F=' id="'+B.attr('id')+j.idSuffix+'"'),B.attr('title')!==void 0&&''!==y.attr('title')&&(G=' title="'+B.attr('title')+'"'),B.attr('class')!==void 0&&(I=' '+B.attr('class'),K=' data-jqfs-class="'+B.attr('class')+'"');var N=B.data();for(var O in N)''!==N[O]&&(H+=' data-'+O+'="'+N[O]+'"');''!=D+I&&(E=' class="'+D+I+'"'),C='<li'+K+H+E+G+F+'>'+B.html()+'</li>',B.parent().is('optgroup')&&(B.parent().attr('class')!==void 0&&(J=' '+B.parent().attr('class')),C='<li'+K+H+' class="'+D+I+' option'+J+'"'+G+F+'>'+B.html()+'</li>',B.is(':first-child')&&(C='<li class="optgroup'+J+'">'+B.parent().attr('label')+'</li>'+C)),z+=C}}function x(){var A=new g,B=a('<div class="jq-select-multiple jqselect"></div>').css({display:'inline-block',position:'relative'}).attr({id:A.id,title:A.title}).addClass(A.classes).data(A.data);h.css({margin:0,padding:0}).after(B),v(),B.append('<ul>'+z+'</ul>');var C=a('ul',B).css({position:'relative','overflow-x':'hidden','-webkit-overflow-scrolling':'touch'}),D=a('li',B).attr('unselectable','on'),E=h.attr('size'),F=C.outerHeight(),G=D.outerHeight();E!==void 0&&0<E?C.css({height:G*E}):C.css({height:4*G}),F>B.height()&&(C.css('overflowY','scroll'),u(C),D.filter('.selected').length&&C.scrollTop(C.scrollTop()+D.filter('.selected').position().top)),h.prependTo(B).css({position:'absolute',left:0,top:0,width:'100%',height:'100%',opacity:0}),h.is(':disabled')?(B.addClass('disabled'),y.each(function(){a(this).is(':selected')&&D.eq(a(this).index()).addClass('selected')})):(D.filter(':not(.disabled):not(.optgroup)').click(function(H){h.focus();var I=a(this);if(H.ctrlKey||H.metaKey||I.addClass('selected'),H.shiftKey||I.addClass('first'),H.ctrlKey||H.metaKey||H.shiftKey||I.siblings().removeClass('selected first'),(H.ctrlKey||H.metaKey)&&(I.is('.selected')?I.removeClass('selected first'):I.addClass('selected first'),I.siblings().removeClass('first')),H.shiftKey){var J=!1,K=!1;I.siblings().removeClass('selected').siblings('.first').addClass('selected'),I.prevAll().each(function(){a(this).is('.first')&&(J=!0)}),I.nextAll().each(function(){a(this).is('.first')&&(K=!0)}),J&&I.prevAll().each(function(){return!a(this).is('.selected')&&void a(this).not('.disabled, .optgroup').addClass('selected')}),K&&I.nextAll().each(function(){return!a(this).is('.selected')&&void a(this).not('.disabled, .optgroup').addClass('selected')}),1==D.filter('.selected').length&&I.addClass('first')}y.prop('selected',!1),D.filter('.selected').each(function(){var L=a(this),M=L.index();L.is('.option')&&(M-=L.prevAll('.optgroup').length),y.eq(M).prop('selected',!0)}),h.change()}),y.each(function(H){a(this).data('optionIndex',H)}),h.on('change.styler',function(){D.removeClass('selected');var H=[];y.filter(':selected').each(function(){H.push(a(this).data('optionIndex'))}),D.not('.optgroup').filter(function(I){return-1<a.inArray(I,H)}).addClass('selected')}).on('focus.styler',function(){B.addClass('focused')}).on('blur.styler',function(){B.removeClass('focused')}),F>B.height()&&h.on('keydown.styler',function(H){(38==H.which||37==H.which||33==H.which)&&C.scrollTop(C.scrollTop()+D.filter('.selected').position().top-G),(40==H.which||39==H.which||34==H.which)&&C.scrollTop(C.scrollTop()+D.filter('.selected:last').position().top-C.innerHeight()+2*G)}))}var y=a('option',h),z='';if(h.is('[multiple]')){if(n||m)return;x()}else(function(){var A=new g,B='',C=h.data('placeholder'),D=h.data('search'),E=h.data('search-limit'),F=h.data('search-not-found'),G=h.data('search-placeholder'),H=h.data('z-index'),I=h.data('smart-positioning');void 0===C&&(C=j.selectPlaceholder),(void 0===D||''===D)&&(D=j.selectSearch),(void 0===E||''===E)&&(E=j.selectSearchLimit),(void 0===F||''===F)&&(F=j.selectSearchNotFound),void 0===G&&(G=j.selectSearchPlaceholder),(void 0===H||''===H)&&(H=j.singleSelectzIndex),(void 0===I||''===I)&&(I=j.selectSmartPositioning);var J=a('<div class="jq-selectbox jqselect"><div class="jq-selectbox__select" style="position: relative"><div class="jq-selectbox__select-text"></div><div class="jq-selectbox__trigger"><div class="jq-selectbox__trigger-arrow"></div></div></div></div>').css({display:'inline-block',position:'relative',zIndex:H}).attr({id:A.id,title:A.title}).addClass(A.classes).data(A.data);h.css({margin:0,padding:0}).after(J).prependTo(J);var K=a('div.jq-selectbox__select',J),L=a('div.jq-selectbox__select-text',J),M=y.filter(':selected');v(),D&&(B='<div class="jq-selectbox__search"><input type="search" autocomplete="off" placeholder="'+G+'"></div><div class="jq-selectbox__not-found">'+F+'</div>');var N=a('<div class="jq-selectbox__dropdown" style="position: absolute">'+B+'<ul style="position: relative; list-style: none; overflow: auto; overflow-x: hidden">'+z+'</ul></div>');J.append(N);var O=a('ul',N),P=a('li',N),Q=a('input',N),R=a('div.jq-selectbox__not-found',N).hide();P.length<E&&Q.parent().hide(),''===y.first().text()&&y.first().is(':selected')&&!1!==C?L.text(C).addClass('placeholder'):L.text(M.text());var S=0,T=0;if(P.css({display:'inline-block'}),P.each(function(){var ba=a(this);ba.innerWidth()>S&&(S=ba.innerWidth(),T=ba.width())}),P.css({display:''}),L.is('.placeholder')&&L.width()>S)L.width(L.width());else{var U=J.clone().appendTo('body').width('auto'),V=U.outerWidth();U.remove(),V==J.outerWidth()&&L.width(T)}S>J.width()&&N.width(S),''===y.first().text()&&''!==h.data('placeholder')&&P.first().hide(),h.css({position:'absolute',left:0,top:0,width:'100%',height:'100%',opacity:0});var W=J.outerHeight(!0),X=Q.parent().outerHeight(!0)||0,Y=O.css('max-height'),Z=P.filter('.selected');1>Z.length&&P.first().addClass('selected sel'),void 0===P.data('li-height')&&P.data('li-height',P.outerHeight());var _=N.css('top');if('auto'==N.css('left')&&N.css({left:0}),'auto'==N.css('top')&&(N.css({top:W}),_=W),N.hide(),Z.length&&(y.first().text()!=M.text()&&J.addClass('changed'),J.data('jqfs-class',Z.data('jqfs-class')),J.addClass(Z.data('jqfs-class'))),h.is(':disabled'))return J.addClass('disabled'),!1;K.click(function(){if(a('div.jq-selectbox').filter('.opened').length&&j.onSelectClosed.call(a('div.jq-selectbox').filter('.opened')),h.focus(),!m){var ba=a(window),ca=P.data('li-height'),da=J.offset().top,ea=ba.height()-W-(da-ba.scrollTop()),fa=h.data('visible-options');(void 0===fa||''===fa)&&(fa=j.selectVisibleOptions);var ga=5*ca,ha=ca*fa;0<fa&&6>fa&&(ga=ha),0===fa&&(ha='auto');var ia=function(){N.height('auto').css({bottom:'auto',top:_});var ka=function(){O.css('max-height',Math.floor((ea-20-X)/ca)*ca)};ka(),O.css('max-height',ha),'none'!=Y&&O.css('max-height',Y),ea<N.outerHeight()+20&&ka()},ja=function(){N.height('auto').css({top:'auto',bottom:_});var ka=function(){O.css('max-height',Math.floor((da-ba.scrollTop()-20-X)/ca)*ca)};ka(),O.css('max-height',ha),'none'!=Y&&O.css('max-height',Y),da-ba.scrollTop()-20<N.outerHeight()+20&&ka()};!0===I||1===I?ea>ga+X+20?(ia(),J.removeClass('dropup').addClass('dropdown')):(ja(),J.removeClass('dropdown').addClass('dropup')):(!1===I||0===I)&&ea>ga+X+20&&(ia(),J.removeClass('dropup').addClass('dropdown')),J.offset().left+N.outerWidth()>ba.width()&&N.css({left:'auto',right:0}),a('div.jqselect').css({zIndex:H-1}).removeClass('opened'),J.css({zIndex:H}),N.is(':hidden')?(a('div.jq-selectbox__dropdown:visible').hide(),N.show(),J.addClass('opened focused'),j.onSelectOpened.call(J)):(N.hide(),J.removeClass('opened dropup dropdown'),a('div.jq-selectbox').filter('.opened').length&&j.onSelectClosed.call(J)),Q.length&&(Q.val('').keyup(),R.hide(),Q.keyup(function(){var ka=a(this).val();P.each(function(){a(this).html().match(new RegExp('.*?'+ka+'.*?','i'))?a(this).show():a(this).hide()}),''===y.first().text()&&''!==h.data('placeholder')&&P.first().hide(),1>P.filter(':visible').length?R.show():R.hide()})),P.filter('.selected').length&&(''===h.val()?O.scrollTop(0):(0!=O.innerHeight()/ca%2&&(ca/=2),O.scrollTop(O.scrollTop()+P.filter('.selected').position().top-O.innerHeight()/2+ca))),u(O)}}),P.hover(function(){a(this).siblings().removeClass('selected')});var aa=P.filter('.selected').text();P.filter(':not(.disabled):not(.optgroup)').click(function(){h.focus();var ba=a(this),ca=ba.text();if(!ba.is('.selected')){var da=ba.index();da-=ba.prevAll('.optgroup').length,ba.addClass('selected sel').siblings().removeClass('selected sel'),y.prop('selected',!1).eq(da).prop('selected',!0),aa=ca,L.text(ca),J.data('jqfs-class')&&J.removeClass(J.data('jqfs-class')),J.data('jqfs-class',ba.data('jqfs-class')),J.addClass(ba.data('jqfs-class')),h.change()}N.hide(),J.removeClass('opened dropup dropdown'),j.onSelectClosed.call(J)}),N.mouseout(function(){a('li.sel',N).addClass('selected')}),h.on('change.styler',function(){L.text(y.filter(':selected').text()).removeClass('placeholder'),P.removeClass('selected sel').not('.optgroup').eq(h[0].selectedIndex).addClass('selected sel'),y.first().text()==P.filter('.selected').text()?J.removeClass('changed'):J.addClass('changed')}).on('focus.styler',function(){J.addClass('focused'),a('div.jqselect').not('.focused').removeClass('opened dropup dropdown').find('div.jq-selectbox__dropdown').hide()}).on('blur.styler',function(){J.removeClass('focused')}).on('keydown.styler keyup.styler',function(ba){var ca=P.data('li-height');''===h.val()?L.text(C).addClass('placeholder'):L.text(y.filter(':selected').text()),P.removeClass('selected sel').not('.optgroup').eq(h[0].selectedIndex).addClass('selected sel'),(38==ba.which||37==ba.which||33==ba.which||36==ba.which)&&(''===h.val()?O.scrollTop(0):O.scrollTop(O.scrollTop()+P.filter('.selected').position().top)),(40==ba.which||39==ba.which||34==ba.which||35==ba.which)&&O.scrollTop(O.scrollTop()+P.filter('.selected').position().top-O.innerHeight()+ca),13==ba.which&&(ba.preventDefault(),N.hide(),J.removeClass('opened dropup dropdown'),j.onSelectClosed.call(J))}).on('keydown.styler',function(ba){32==ba.which&&(ba.preventDefault(),K.click())}),c.registered||(a(document).on('click',c),c.registered=!0)})()};s(),h.on('refresh',function(){h.off('.styler').parent().before(h).remove(),s()})}else h.is(':reset')&&h.on('click',function(){setTimeout(function(){h.closest('form').find('input, select').trigger('refresh')},1)})},destroy:function(){var g=a(this.element);g.is(':checkbox')||g.is(':radio')?(g.removeData('_'+d).off('.styler refresh').removeAttr('style').parent().before(g).remove(),g.closest('label').add('label[for="'+g.attr('id')+'"]').off('.styler')):g.is('input[type="number"]')?g.removeData('_'+d).off('.styler refresh').closest('.jq-number').before(g).remove():(g.is(':file')||g.is('select'))&&g.removeData('_'+d).off('.styler refresh').removeAttr('style').parent().before(g).remove()}},a.fn[d]=function(g){var h=arguments;if(void 0===g||'object'==typeof g)return this.each(function(){a.data(this,'_'+d)||a.data(this,'_'+d,new b(this,g))}).promise().done(function(){var m=a(this[0]).data('_'+d);m&&m.options.onFormStyled.call()}),this;if('string'==typeof g&&'_'!==g[0]&&'init'!==g){var j;return this.each(function(){var m=a.data(this,'_'+d);m instanceof b&&'function'==typeof m[g]&&(j=m[g].apply(m,Array.prototype.slice.call(h,1)))}),void 0===j?this:j}},c.registered=!1});